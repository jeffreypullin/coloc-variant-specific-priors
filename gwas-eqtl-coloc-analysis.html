<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>coloc estimated eQTL priors - GWAS-eQTL colocalisation analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">coloc estimated eQTL priors</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">GWAS-eQTL colocalisation analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">load</span>(here<span class="sc">::</span><span class="fu">here</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- The project is out-of-sync -- use `renv::status()` for details.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yaml)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(<span class="st">"~/coloc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>config <span class="ot">&lt;-</span> <span class="fu">read_yaml</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"config.yaml"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>gwas_ids_eqtl_ids <span class="ot">&lt;-</span> config<span class="sc">$</span>gwas_eqtl_coloc_ids</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">chr =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">gwas_id_eqtl_id =</span> gwas_ids_eqtl_ids</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(gwas_id_eqtl_id, <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"gwas_id"</span>, <span class="st">"eqtl_id"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"output/data/gwas-eqtl-coloc-{gwas_id}-{eqtl_id}-{chr}.rds"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">list</span>(<span class="fu">read_rds</span>(file))) <span class="sc">|&gt;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gwas_id <span class="sc">==</span> <span class="st">"AUTOIMMUNE"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PP.H4.abf_unif <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gwas_id, eqtl_id, gene_name, PP.H4.abf_unif) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 89 × 4
   gwas_id    eqtl_id   gene_name PP.H4.abf_unif
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
 1 AUTOIMMUNE QTD000373 MMEL1              0.943
 2 AUTOIMMUNE QTD000373 CEPT1              0.991
 3 AUTOIMMUNE QTD000373 DENND2D            0.991
 4 AUTOIMMUNE QTD000373 GPR25              0.885
 5 AUTOIMMUNE QTD000341 MMEL1              0.922
 6 AUTOIMMUNE QTD000341 VAV3               0.999
 7 AUTOIMMUNE QTD000095 INPP5B             0.975
 8 AUTOIMMUNE QTD000021 MMEL1              0.905
 9 AUTOIMMUNE QTD000021 FUBP1              0.999
10 AUTOIMMUNE QTD000031 MMEL1              0.951
11 AUTOIMMUNE QTD000031 TTC34              0.991
12 AUTOIMMUNE QTD000031 SLC66A1            0.824
13 AUTOIMMUNE QTD000031 DRAM2              0.991
14 AUTOIMMUNE QTD000031 CEPT1              0.991
15 AUTOIMMUNE QTD000031 DENND2D            0.991
16 AUTOIMMUNE QTD000090 VAV3               0.948
17 AUTOIMMUNE QTD000373 PUS10              0.929
18 AUTOIMMUNE QTD000373 C2orf74            0.940
19 AUTOIMMUNE QTD000373 PPIL3              0.997
20 AUTOIMMUNE QTD000341 TPO                0.993
21 AUTOIMMUNE QTD000341 C2orf74            0.921
22 AUTOIMMUNE QTD000341 ACTR1B             0.984
23 AUTOIMMUNE QTD000341 PPIL3              0.980
24 AUTOIMMUNE QTD000095 ADCY3              0.886
25 AUTOIMMUNE QTD000095 PPIL3              0.997
26 AUTOIMMUNE QTD000021 ADCY3              0.809
27 AUTOIMMUNE QTD000021 PUS10              0.925
28 AUTOIMMUNE QTD000021 ANKRD36            0.977
29 AUTOIMMUNE QTD000021 ACTR1B             0.962
30 AUTOIMMUNE QTD000021 PPIL3              0.995
31 AUTOIMMUNE QTD000031 PUS10              0.912
32 AUTOIMMUNE QTD000031 ANKRD36            0.983
33 AUTOIMMUNE QTD000031 ACTR1B             0.984
34 AUTOIMMUNE QTD000031 TYW5               0.919
35 AUTOIMMUNE QTD000031 PPIL3              0.995
36 AUTOIMMUNE QTD000090 CIAO1              0.896
37 AUTOIMMUNE QTD000090 PPIL3              0.996
38 AUTOIMMUNE QTD000090 TIMP4              0.937
39 AUTOIMMUNE QTD000373 ANKRD55            1.00 
40 AUTOIMMUNE QTD000341 PDE8B              0.990
41 AUTOIMMUNE QTD000031 ANKRD55            1.00 
42 AUTOIMMUNE QTD000021 H4C13              0.918
43 AUTOIMMUNE QTD000031 H4C13              0.977
44 AUTOIMMUNE QTD000031 BACH2              0.999
45 AUTOIMMUNE QTD000090 ITPR3              0.908
46 AUTOIMMUNE QTD000373 IRF5               0.994
47 AUTOIMMUNE QTD000341 IRF5               0.989
48 AUTOIMMUNE QTD000021 IRF5               0.906
49 AUTOIMMUNE QTD000090 IRF5               0.988
50 AUTOIMMUNE QTD000341 RAB2A              0.943
51 AUTOIMMUNE QTD000090 RAB2A              0.938
52 AUTOIMMUNE QTD000341 RAB14              0.866
53 AUTOIMMUNE QTD000341 NEK6               0.990
54 AUTOIMMUNE QTD000021 TNFSF8             0.984
55 AUTOIMMUNE QTD000021 TRAF1              0.927
56 AUTOIMMUNE QTD000373 SLC29A3            0.999
57 AUTOIMMUNE QTD000341 NKX2-3             1.00 
58 AUTOIMMUNE QTD000341 IRF7               0.900
59 AUTOIMMUNE QTD000341 DRD4               0.838
60 AUTOIMMUNE QTD000095 PRR5L              0.992
61 AUTOIMMUNE QTD000021 LMNTD2             0.968
62 AUTOIMMUNE QTD000373 METTL7B            0.944
63 AUTOIMMUNE QTD000031 MARS1              0.889
64 AUTOIMMUNE QTD000021 COG6               0.974
65 AUTOIMMUNE QTD000090 COG6               0.943
66 AUTOIMMUNE QTD000095 RASGRP1            0.985
67 AUTOIMMUNE QTD000373 GINS2              0.808
68 AUTOIMMUNE QTD000021 BRD7               0.884
69 AUTOIMMUNE QTD000031 APOBR              0.998
70 AUTOIMMUNE QTD000373 ACAP1              0.997
71 AUTOIMMUNE QTD000373 KCTD11             0.997
72 AUTOIMMUNE QTD000031 ACAP1              0.997
73 AUTOIMMUNE QTD000031 KCTD11             0.997
74 AUTOIMMUNE QTD000090 ORMDL3             0.918
75 AUTOIMMUNE QTD000090 KCNH4              0.934
76 AUTOIMMUNE QTD000373 CD226              0.989
77 AUTOIMMUNE QTD000373 IQCN               0.976
78 AUTOIMMUNE QTD000373 NTN5               0.911
79 AUTOIMMUNE QTD000341 NTN5               0.909
80 AUTOIMMUNE QTD000021 IQCN               0.975
81 AUTOIMMUNE QTD000373 UBASH3A            0.954
82 AUTOIMMUNE QTD000341 UBASH3A            0.954
83 AUTOIMMUNE QTD000031 UBASH3A            0.954
84 AUTOIMMUNE QTD000090 UBASH3A            0.916
85 AUTOIMMUNE QTD000373 SYNGR1             0.906
86 AUTOIMMUNE QTD000095 SYNGR1             0.909
87 AUTOIMMUNE QTD000021 LIF                0.998
88 AUTOIMMUNE QTD000021 DDX17              0.920
89 AUTOIMMUNE QTD000031 DDX17              0.962</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gwas_id <span class="sc">==</span> <span class="st">"AUTOIMMUNE"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PP.H4.abf_unif <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gene_name) <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">47</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 2
   gene_name     n
   &lt;chr&gt;     &lt;int&gt;
 1 PPIL3         6
 2 IRF5          4
 3 MMEL1         4
 4 UBASH3A       4
 5 ACTR1B        3
 6 PUS10         3
 7 ACAP1         2
 8 ADCY3         2
 9 ANKRD36       2
10 ANKRD55       2
11 C2orf74       2
12 CEPT1         2
13 COG6          2
14 DDX17         2
15 DENND2D       2
16 H4C13         2
17 IQCN          2
18 KCTD11        2
19 NTN5          2
20 RAB2A         2
21 SYNGR1        2
22 VAV3          2
23 APOBR         1
24 BACH2         1
25 BRD7          1
26 CD226         1
27 CIAO1         1
28 DRAM2         1
29 DRD4          1
30 FUBP1         1
31 GINS2         1
32 GPR25         1
33 INPP5B        1
34 IRF7          1
35 ITPR3         1
36 KCNH4         1
37 LIF           1
38 LMNTD2        1
39 MARS1         1
40 METTL7B       1
41 NEK6          1
42 NKX2-3        1
43 ORMDL3        1
44 PDE8B         1
45 PRR5L         1
46 RAB14         1
47 RASGRP1       1
# ℹ 8 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gwas_id <span class="sc">==</span> <span class="st">"AUTOIMMUNE"</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PP.H4.abf_unif <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(eqtl_id) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">47</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  eqtl_id       n
  &lt;chr&gt;     &lt;int&gt;
1 QTD000031    20
2 QTD000373    19
3 QTD000021    17
4 QTD000341    16
5 QTD000090    11
6 QTD000095     6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gwas_id <span class="sc">==</span> <span class="st">"T2D_WIDE"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PP.H4.abf_unif <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gwas_id, eqtl_id, gene_name, PP.H4.abf_unif) <span class="sc">|&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 34 × 4
   gwas_id  eqtl_id   gene_name PP.H4.abf_unif
   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;
 1 T2D_WIDE QTD000373 PABPC4             0.935
 2 T2D_WIDE QTD000090 TSEN2              0.998
 3 T2D_WIDE QTD000090 CENPW              0.945
 4 T2D_WIDE QTD000296 NUS1               0.992
 5 T2D_WIDE QTD000090 GTF2I              1.00 
 6 T2D_WIDE QTD000090 FAM185A            0.985
 7 T2D_WIDE QTD000090 KLF14              0.961
 8 T2D_WIDE QTD000090 AOC1               0.844
 9 T2D_WIDE QTD000296 JAZF1              0.968
10 T2D_WIDE QTD000296 GTF2I              1.00 
11 T2D_WIDE QTD000373 ANKS6              0.995
12 T2D_WIDE QTD000373 NUDT5              0.884
13 T2D_WIDE QTD000373 CAMK1D             0.998
14 T2D_WIDE QTD000373 SLIT1              0.979
15 T2D_WIDE QTD000090 ARHGAP19           0.906
16 T2D_WIDE QTD000321 SLIT1              0.988
17 T2D_WIDE QTD000090 SMIM38             0.823
18 T2D_WIDE QTD000321 SMIM38             0.884
19 T2D_WIDE QTD000296 CLIP1              0.805
20 T2D_WIDE QTD000090 MARK3              0.921
21 T2D_WIDE QTD000373 AP3S2              0.968
22 T2D_WIDE QTD000090 AP3S2              0.969
23 T2D_WIDE QTD000090 ARPIN              0.939
24 T2D_WIDE QTD000266 AP3S2              0.975
25 T2D_WIDE QTD000321 AP3S2              0.968
26 T2D_WIDE QTD000296 AP3S2              0.954
27 T2D_WIDE QTD000261 AP3S2              0.960
28 T2D_WIDE QTD000373 RMC1               0.877
29 T2D_WIDE QTD000090 RMC1               0.942
30 T2D_WIDE QTD000296 NPC1               0.874
31 T2D_WIDE QTD000373 DMPK               0.933
32 T2D_WIDE QTD000373 DMWD               0.948
33 T2D_WIDE QTD000296 DMWD               0.941
34 T2D_WIDE QTD000373 NELFCD             0.990</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gene_name, gwas_id, <span class="fu">starts_with</span>(<span class="st">"PP.H4.abf"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">c</span>(gene_name, gwas_id), </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"prior"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"pp_h4"</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_coloc =</span> pp_h4 <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_sig =</span> <span class="fu">sum</span>(sig_coloc), <span class="at">.by =</span> <span class="fu">c</span>(prior, gwas_id)) <span class="sc">|&gt;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_unif =</span> prior <span class="sc">==</span> <span class="st">"PP.H4.abf_unif"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior =</span> <span class="fu">fct_reorder</span>(<span class="fu">factor</span>(prior), n_sig, mean)) <span class="sc">|&gt;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(prior, n_sig, <span class="at">fill =</span> is_unif)) <span class="sc">+</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of signifcant (Pr(H4) &gt; 0.8) colocalisations"</span>, </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Prior type"</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gwas_id, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span> </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="gwas-eqtl-coloc-analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>CRIP3 colocalises in monocytes CHP1 colocalises in eQTLGen PIGV colocalises in monocytes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_abc_score_gwas =</span> PP.H4.abf_abc_score_gwas <span class="sc">&gt;</span> <span class="fl">0.8</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_unif =</span> PP.H4.abf_unif <span class="sc">&gt;</span> <span class="fl">0.8</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(gwas_id) <span class="sc">|&gt;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sig_abc_score_gwas <span class="sc">!=</span> sig_unif) <span class="sc">|&gt;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gwas_id, eqtl_id, gene_name,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>         PP.H4.abf_unif, PP.H4.abf_abc_score_gwas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 5
   gwas_id    eqtl_id   gene_name PP.H4.abf_unif PP.H4.abf_abc_score_gwas
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;                    &lt;dbl&gt;
 1 AUTOIMMUNE QTD000021 ADCY3              0.809                    0.778
 2 AUTOIMMUNE QTD000341 PSMD5              0.187                    0.814
 3 AUTOIMMUNE QTD000021 CNTRL              0.696                    0.881
 4 AUTOIMMUNE QTD000341 DRD4               0.838                    0.795
 5 AUTOIMMUNE QTD000341 GINS2              0.749                    0.883
 6 I9_HYPTENS QTD000373 LMNA               0.586                    0.802
 7 I9_HYPTENS QTD000549 PIGV               0.759                    0.804
 8 T2D_WIDE   QTD000296 ST6GAL1            0.690                    0.923
 9 T2D_WIDE   QTD000296 MLXIPL             0.670                    0.806
10 T2D_WIDE   QTD000373 KLHL42             0.784                    0.803
11 T2D_WIDE   QTD000296 CKB                0.798                    0.802</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_gwas_tss_eqtlgen =</span> PP.H4.abf_gwas_tss_eqtlgen <span class="sc">&gt;</span> <span class="fl">0.8</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig_unif =</span> PP.H4.abf_unif <span class="sc">&gt;</span> <span class="fl">0.8</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(gwas_id) <span class="sc">|&gt;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sig_gwas_tss_eqtlgen <span class="sc">!=</span> sig_unif) <span class="sc">|&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gwas_id, eqtl_id, gene_name,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>         PP.H4.abf_unif, PP.H4.abf_gwas_tss_eqtlgen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 5
   gwas_id    eqtl_id   gene_name PP.H4.abf_unif PP.H4.abf_gwas_tss_eqtlgen
   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;                      &lt;dbl&gt;
 1 AUTOIMMUNE QTD000373 SLC66A1            0.686                      0.937
 2 AUTOIMMUNE QTD000341 SLC66A1            0.789                      0.940
 3 AUTOIMMUNE QTD000095 CTTNBP2NL          0.629                      0.813
 4 AUTOIMMUNE QTD000021 ADCY3              0.809                      0.664
 5 AUTOIMMUNE QTD000021 CNTRL              0.696                      0.854
 6 AUTOIMMUNE QTD000341 GINS2              0.749                      0.846
 7 I9_HYPTENS QTD000549 PIGV               0.759                      0.826
 8 I9_HYPTENS QTD000373 CRIP3              0.787                      0.804
 9 I9_HYPTENS QTD000373 NACA               0.784                      0.907
10 I9_HYPTENS QTD000373 CHP1               0.765                      0.839
11 I9_HYPTENS QTD000373 FZD2               0.764                      0.829
12 T2D_WIDE   QTD000090 MYEOV              0.590                      0.834
13 T2D_WIDE   QTD000321 SMIM38             0.884                      0.789
14 T2D_WIDE   QTD000296 CKB                0.798                      0.881</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gene_name <span class="sc">==</span> <span class="st">"GINS2"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gwas_id, eqtl_id, gene_name, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        PP.H4.abf_unif, PP.H4.abf_abc_score_gwas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  gwas_id    eqtl_id   gene_name PP.H4.abf_unif PP.H4.abf_abc_score_gwas
  &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;              &lt;dbl&gt;                    &lt;dbl&gt;
1 AUTOIMMUNE QTD000373 GINS2              0.808                    0.892
2 AUTOIMMUNE QTD000341 GINS2              0.749                    0.883</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PP.H4.abf_unif, PP.H4.abf_abc_score_gwas)) <span class="sc">+</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="gwas-eqtl-coloc-analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>gwas_eqtl_colocs <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PP.H4.abf_unif, PP.H4.abf_gwas_tss_eqtlgen)) <span class="sc">+</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="gwas-eqtl-coloc-analysis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>