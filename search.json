[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Home",
    "section": "",
    "text": "TODO"
  },
  {
    "objectID": "gtex-prior-estimation.html",
    "href": "gtex-prior-estimation.html",
    "title": "GTEx prior analysis",
    "section": "",
    "text": "library(conflicted)\nlibrary(readr)\nlibrary(MASS)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(janitor)\nlibrary(purrr)\nlibrary(fitdistrplus)\nlibrary(VGAM)\n\nconflicts_prefer(dplyr::select)\nconflicts_prefer(dplyr::filter)\n\n\ngtex_whole_blood_raw &lt;- read_tsv(\n  here::here(\"data\", \"GTEx_Analysis_v8_eQTL\", \"Whole_Blood.v8.signif_variant_gene_pairs.txt\"),\n  show_col_types = FALSE\n)\n\n# This processing reproduces the processing described in (Fauman and Hyde 2022)\ngtex_whole_blood &lt;- gtex_whole_blood_raw |&gt; \n  group_by(gene_id) |&gt; \n  arrange(pval_nominal) |&gt; \n  filter(row_number() == 1) |&gt; \n  filter(pval_nominal &lt; 5 * 10^-8) |&gt; \n  mutate(abs_tss_distance = abs(tss_distance)) |&gt; \n  mutate(log10_abs_tss_distance = log10(abs_tss_distance)) |&gt; \n  filter(log10_abs_tss_distance &gt; 0) |&gt; \n  mutate(log10_dist = log10_abs_tss_distance)\n\n\nweibull_param &lt;- gtex_whole_blood |&gt; \n  pull(log10_dist) |&gt; \n  fitdistr(\"weibull\", lower = c(0, 0)) |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\nlognormal_param &lt;- gtex_whole_blood |&gt; \n  pull(log10_dist) |&gt; \n  fitdistr(\"lognormal\", lower = c(0, 0)) |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\nnormal_param &lt;- gtex_whole_blood |&gt; \n  pull(log10_dist) |&gt; \n  fitdistr(\"normal\") |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\ngamma_param &lt;- gtex_whole_blood |&gt; \n  pull(log10_dist) |&gt; \n  fitdistr(\"gamma\", lower = c(0, 0)) |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\npgumbel &lt;- function(q,...) {\n  if (length(q) == 0) {\n    numeric(0) \n  } else {\n    VGAM::pgumbel(q,...)\n  }\n}\n\ngumbel_param &lt;- gtex_whole_blood |&gt; \n  pull(log10_dist) |&gt; \n  fitdistrplus::fitdist(\"gumbel\", start=list(location = 3, scale = 1)) |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\ngtex_whole_blood |&gt; \n  ggplot(aes(log10_dist)) + \n  geom_histogram(aes(y = after_stat(density)), \n                 binwidth = 0.25, colour = \"black\", fill = \"lightgrey\") + \n  geom_function(aes(col = \"Weibull\"), fun = dweibull, args = weibull_param) +\n  geom_function(aes(col = \"Normal\"), fun = dnorm, args = normal_param) +\n  geom_function(aes(col = \"Gamma\"), fun = dgamma, args = gamma_param) +\n  geom_function(aes(col = \"Log-normal\"), fun = dlnorm, args = lognormal_param) +\n  geom_function(aes(col = \"Gumbel\"), fun = dgumbel, args = gumbel_param) +\n  scale_colour_manual(values = c(\"red\",\"black\",\"purple\", \"green\", \"blue\")) + \n  labs(\n    colour = \"Distribution\",\n    y = \"Density\", \n    x = \"Log(10) distance from variant to TSS\",\n    title = \"GTEx whole blood data\"\n  ) + \n  theme_bw() \n\n\n\n\n\ngtex_lung_raw &lt;- read_tsv(\n  here::here(\"data\", \"GTEx_Analysis_v8_eQTL\", \"Lung.v8.signif_variant_gene_pairs.txt\"),\n  show_col_types = FALSE\n)\n\n# This processing reproduces the processing described in (Fauman and Hyde 2022)\ngtex_lung &lt;- gtex_lung_raw |&gt; \n  group_by(gene_id) |&gt; \n  arrange(pval_nominal) |&gt; \n  filter(row_number() == 1) |&gt; \n  filter(pval_nominal &lt; 5 * 10^-8) |&gt; \n  mutate(abs_tss_distance = abs(tss_distance)) |&gt; \n  mutate(log10_abs_tss_distance = log10(abs_tss_distance)) |&gt; \n  filter(log10_abs_tss_distance &gt; 0) |&gt; \n  mutate(log10_dist = log10_abs_tss_distance)\n\n\nweibull_param &lt;- gtex_lung |&gt; \n  pull(log10_dist) |&gt; \n  fitdistr(\"weibull\", lower = c(0, 0)) |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\nlognormal_param &lt;- gtex_lung |&gt; \n  pull(log10_dist) |&gt; \n  fitdistr(\"lognormal\", lower = c(0, 0)) |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\nnormal_param &lt;- gtex_whole_blood |&gt; \n  pull(log10_dist) |&gt; \n  fitdistr(\"normal\") |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\ngamma_param &lt;- gtex_lung |&gt; \n  pull(log10_dist) |&gt; \n  fitdistr(\"gamma\", lower = c(0, 0)) |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\npgumbel &lt;- function(q,...) {\n  if (length(q) == 0) {\n    numeric(0) \n  } else {\n    VGAM::pgumbel(q,...)\n  }\n}\n\ngumbel_param &lt;- gtex_lung |&gt; \n  pull(log10_dist) |&gt; \n  fitdistrplus::fitdist(\"gumbel\", start=list(location = 3, scale = 1)) |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\ngtex_lung |&gt; \n  ggplot(aes(log10_dist)) + \n  geom_histogram(aes(y = after_stat(density)), \n                 binwidth = 0.25, colour = \"black\", fill = \"lightgrey\") + \n  geom_function(aes(col = \"Weibull\"), fun = dweibull, args = weibull_param) +\n  geom_function(aes(col = \"Normal\"), fun = dnorm, args = normal_param) +\n  geom_function(aes(col = \"Gamma\"), fun = dgamma, args = gamma_param) +\n  geom_function(aes(col = \"Log-normal\"), fun = dlnorm, args = lognormal_param) +\n  geom_function(aes(col = \"Gumbel\"), fun = dgumbel, args = gumbel_param) +\n  scale_colour_manual(values = c(\"red\",\"black\",\"purple\", \"green\", \"blue\")) + \n  labs(\n    colour = \"Distribution\",\n    y = \"Density\", \n    x = \"Log(10) distance from variant to TSS\",\n    title = \"GTEx lung data\"\n  ) + \n  theme_bw()"
  },
  {
    "objectID": "eqtlgen-prior-estimation.html",
    "href": "eqtlgen-prior-estimation.html",
    "title": "eqtlgen prior estimation",
    "section": "",
    "text": "library(conflicted)\nlibrary(readr)\nlibrary(MASS)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(janitor)\nlibrary(purrr)\n\nconflicts_prefer(dplyr::select)\nconflicts_prefer(dplyr::filter)\n\n\neqtlgen &lt;- read_tsv(here::here(\"data\", \"eqtlgen.tsv\"),\n                    show_col_types = FALSE, \n                    name_repair = make_clean_names) |&gt; \n  rename(p_value = pvalue) |&gt; \n  mutate(log10_dist = log(dist, base = 10)) |&gt;\n  filter(log10_dist &gt; 0) \n\n\nweibull_param &lt;- eqtlgen |&gt; \n  pull(log10_dist) |&gt; \n  fitdistr(\"weibull\", lower = c(0, 0)) |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\nnormal_param &lt;- eqtlgen$log10_dist |&gt; \n  fitdistr(\"normal\") |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\ngamma_param &lt;- eqtlgen |&gt; \n  pull(log10_dist) |&gt; \n  fitdistr(\"gamma\", lower = c(0, 0)) |&gt; \n  pluck(\"estimate\") |&gt; \n  as.list()\n\neqtlgen |&gt; \n  ggplot(aes(log10_dist)) + \n  geom_histogram(aes(y = after_stat(density)), \n                 binwidth = 0.25, colour = \"black\", fill = \"lightgrey\") + \n  geom_function(aes(col = \"Weibull\"), fun = dweibull, args = weibull_param) +\n  geom_function(aes(col = \"Normal\"), fun = dnorm, args = normal_param) +\n  geom_function(aes(col = \"Gamma\"), fun = dgamma, args = gamma_param) +\n  scale_colour_manual(values = c(\"red\",\"black\",\"purple\")) + \n  labs(\n    colour = \"Distribution\",\n    y = \"Density\", \n    x = \"Log(10) distance from variant to TSS of cognate gene\"\n  ) + \n  theme_bw()"
  }
]